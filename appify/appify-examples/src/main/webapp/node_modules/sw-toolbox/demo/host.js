'use strict';

document.addEventListener('DOMContentLoaded', function() {
  var statechangeLogger = function(name, event) {
    console.log(name + ': State now ' + event.target.state);
  };

  var logger = function(message) {
    console.log(message);
  };

  Notification.requestPermission(logger);

  navigator.serviceWorker.register('service-worker.js', { scope: './' })
  .then(function(registration) {
    console.log(registration);
    var sws = ['active', 'installing', 'waiting'];
    sws.forEach(function(sw) {
      if (registration[sw]) {
        console.log('Found ' + sw + ' service worker');
        registration[sw]
        .addEventListener('statechange', statechangeLogger.bind(null, sw));
      }
    });
  });

  // navigator.serviceWorker.ready.then(function (sw) {
  //   navigator.push.register().then(function (pushRegistration) {
  //     console.log('Push Registration', pushRegistration);
  //   })
  // });
});
